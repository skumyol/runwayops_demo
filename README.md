# Runway Ops Demo

Runway Ops Demo is a Cathay-aligned flight disruption command center. A FastAPI backend supplies flight, crew, and passenger data in synthetic or realtime modes, while a Vite + React dashboard turns those feeds into IOC tooling and agentic decision aids. Use this repository to showcase disruption monitoring, what-if simulation, and multi-agent recommendations in a single local stack.

## Highlights
- **Live flight monitor** – Track CX/HKG operations with predictive risk signals in synthetic, aviationstack, or Mongo-backed modes.
- **IOC & passenger workflows** – Manage disruption queues, passenger cohorts, and detailed manifests with finance + rebooking helpers.
- **What-if simulator** – Run scenario analysis and stream results from the backend via SSE.
- **Agentic analysis** – Backend `app/agentsv2` hosts Google ADK workflows that combine finance, crew, risk, and reaccommodation guidance.
- **Mock + persistence story** – Refresh fixtures through `scripts/generate_mock_data.py` and optionally persist audits in MongoDB.

## Repository Layout
```
backend/              FastAPI (entrypoint: app/main.py)
frontend/dashboard/   React + TypeScript + Vite dashboard
mock/                 JSON fixtures generated by scripts/generate_mock_data.py
scripts/              Helper scripts (mock data, flight ticker, agent debugging)
run_dev.sh            Boots backend (8000) + frontend (3000) with shared logs
AGENTS.md             Working guidelines and repo conventions
```
Supporting docs such as `PREDICTIVE_SIGNALS_INTEGRATION.md`, `amadeus_integration.md`, and `agentic_system.md` cover deeper details per subsystem.

## Quick Start
### 1. Prerequisites
- Python 3.12 with [uv](https://github.com/astral-sh/uv) (or pip/venv if preferred)
- Node.js 18+ (npm or pnpm)
- MongoDB 7 locally if you plan to run `mongo` mode or persist agent history
- API keys (optional): `AVIATIONSTACK_API_KEY`, `OPENAI_API_KEY`, Amadeus credentials

### 2. Install dependencies
```bash
# Backend
cd backend
uv pip install -r requirements.txt  # pip install -r requirements.txt also works

# Frontend
cd ../frontend/dashboard
npm install  # or pnpm install
```

### 3. Configure environments
Create `backend/.env` and `frontend/dashboard/.env.local` from their `.env.example` templates. Common values:
```bash
# backend/.env
FLIGHT_MONITOR_MODE=synthetic   # synthetic | realtime | mongo
AVIATIONSTACK_API_KEY=sk-...    # only needed for realtime mode
MONGO_URI=mongodb://localhost:27017
MONGO_DB_NAME=runwayops
AGENTIC_ENABLED=true
OPENAI_API_KEY=sk-...
LLM_MODEL=gpt-4o

# frontend/dashboard/.env.local
VITE_MONITOR_API=http://127.0.0.1:8000
VITE_DEFAULT_MONITOR_MODE=synthetic
```
Keep secrets in those files; they are gitignored.

### 4. Run everything
```bash
./run_dev.sh
```
The script clears ports 8000/3000, warms the local `.uv-cache`, seeds Mongo (unless `--skip-seed`), and launches:
- FastAPI backend on http://127.0.0.1:8000 (Swagger at `/docs`)
- Vite dev server on http://127.0.0.1:3000

Useful flags:
- `--skip-seed` – reuse existing Mongo fixtures
- `--flights N --base-passengers M` – customize seeding volume
- `--ticker --ticker-sleep 45` – also start `scripts/flight_ticker.py`

### Running services individually
```bash
# Backend only (reload on save)
cd backend
uv run uvicorn app.main:app --reload --port 8000

# Frontend only
cd frontend/dashboard
npm run dev
```

## Data & Mock Fixtures
- `scripts/generate_mock_data.py` populates MongoDB and refreshes the JSON fixtures under `mock/`.
- `scripts/flight_ticker.py` simulates rolling delay updates (useful together with `--ticker`).
- `mock/` files back the synthetic mode and serve as offline fallbacks.

By default `FLIGHT_MONITOR_MODE=synthetic`, so you can browse the dashboard without Mongo or API keys. Switch to `realtime` or `mongo` once the external services are ready.

## Agentic & LLM Configuration
- Backend logic sits in `backend/app/agentsv2` with providers and settings defined in `app/providers` and `app/config.py`.
- Enable the workflow by setting `AGENTIC_ENABLED=true` and pointing `LLM_PROVIDER`, `LLM_MODEL`, and provider-specific keys in `backend/.env`.
- The frontend exposes agent controls inside views such as **RealtimeFlightMonitor** and **IOCQueues**; the selected engine is managed through `AgenticContext`.
- Detailed provider instructions live in `LLM_PROVIDERS.md` and `agentic_system.md`.

## Testing & Verification
Automated suites are not wired up yet. Follow the repo guidelines:
- Backend tests belong in `backend/tests` and should use `pytest` + `pytest-asyncio` with `httpx.AsyncClient`.
- Frontend tests belong in `frontend/dashboard/src` using `vitest` + `@testing-library/react`.
- Add manual verification notes (e.g., `./run_dev.sh`, screenshots) when sharing changes.

## Additional Resources
- `AGENTS.md` – coding standards, naming conventions, and deployment notes
- `PREDICTIVE_SIGNALS_INTEGRATION.md` – how risk scores are produced
- `amadeus_integration.md` – airline + hotel data onboarding
- `agentic_system.md` – ADK workflow details

This README intentionally stays high-level; dive into the linked docs for subsystem specifics.
